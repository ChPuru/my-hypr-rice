# ----------------------------------------------------- 
# Hyprland Config :: Catppuccin Mocha
# ----------------------------------------------------- 

# --- Plugins ---
plugin = /usr/lib/hyprland/plugins/burn-my-windows.so

# --- Monitors ---
monitor=,highrr,auto,1
monitor=,preferred,auto,1,transform,0

# --- Autostart ---
exec-once = ~/.config/hypr/hyprland/scripts/start_geoclue_agent.sh
exec-once = qs -c $qsConfig &
exec-once = fcitx5
exec-once = gnome-keyring-daemon --start --components=secrets
exec-once = /usr/lib/polkit-kde-authentication-agent-1 || /usr/libexec/polkit-kde-authentication-agent-1  || /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1 || /usr/libexec/polkit-gnome-authentication-agent-1
exec-once = dbus-update-activation-environment --all
exec-once = hyprpm reload
exec-once = easyeffects --gapplication-service
exec-once = hyprctl setcursor Bibata-Modern-Classic 24
exec-once = sleep 0.3 && swaync
exec-once = swww-daemon
exec-once = nm-applet --indicator
exec-once = blueman-applet
exec-once = eww daemon && eww open bar
exec-once = sleep 2 && ags
exec-once = wl-paste --type text --watch cliphist store
exec-once = wl-paste --type image --watch cliphist store
exec-once = hypridle
exec-once = sleep 1 && swww img ~/Pictures/wallpapers/catppuccin.png --transition-type grow --transition-step 5 --transition-fps 144
exec-once = cava -c ~/.config/cava/config &
exec-once = spotify-tui &
exec-once = ~/.config/scripts/random-wall.sh &
exec-once = [workspace name:notion silent] notion-app
exec-once = vesktop
exec-once = hyprsunset -t 5200
exec-once = ~/.config/scripts/battery-status.sh
exec-once=systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
#exec-once = hyprctl setcursor Adwaita 20
exec = gsettings set org.gnome.desktop.interface gtk-theme 'catppuccin-mocha-lavender-standard+default'
exec = gsettings set org.gnome.desktop.interface color-scheme 'prefer-dark'
exec = gsettings set org.gnome.desktop.interface font-name 'SFRounded Nerd Font 14'
exec = gsettings set org.gnome.desktop.interface document-font-name 'NewYork Nerd Font 11'
exec = gsettings set org.gnome.desktop.interface monospace-font-name 'SFMono Nerd Font Mono  13'
exec = gsettings set org.gnome.desktop.interface font-antialiasing 'rgba'
exec = gsettings set org.gnome.desktop.interface font-hinting 'full'
exec-once=waybar
exec-once = ~/.config/scripts/xdgdesktop
exec-once = ~/.config/scripts/gtkthemes

#Notification 
exec-once=dunst

# Wallpaper
#exec-once=swaybg -o \* -i ~/.config/hypr/wallpapers/night.jpg -m fill
exec-once= ~/.config/scripts/initWall
exec-once= ~/.config/hypr/scripts/startpage.sh

# Bluetooth
exec-once=blueman-applet # Make sure you have installed blueman

# Screen Sharing 
exec-once=~/.config/hypr/scripts/screensharing.sh

# --- Source Other Configs ---
source = ~/.config/hypr/keybinds.conf
source = ~/.config/hypr/windowrules.conf
source = ~/.config/hypr/workspaces.conf
exec = hyprctl dispatch submap global # DO NOT REMOVE THIS OR YOU WON'T BE ABLE TO USE ANY KEYBIND
submap = global # This is required for catchall to work
source= ~/.config/hypr/hyprland/colors.conf

# --- Environment Variables ---
env = QT_IM_MODULE, fcitx
env = XMODIFIERS, @im=fcitx
env = SDL_IM_MODULE, fcitx
env = GLFW_IM_MODULE, ibus
env = INPUT_METHOD, fcitx
env = XCURSOR_THEME,Bibata-Modern-Classic
env = GTK_THEME,Catppuccin-Mocha-Standard-Mauve-Dark
env = QT_QPA_PLATFORMTHEME,qt6ct
env = QT_WAYLAND_DISABLE_WINDOWDECORATION,1
env = GBM_BACKEND,nvidia-drm
env = __GLX_VENDOR_LIBRARY_NAME,nvidia
env = WLR_NO_HARDWARE_CURSORS,1
env = LIBVA_DRIVER_NAME,nvidia
env = GBM_BACKEND,nvidia-drm
env = WLR_RENDERER,vulkan
env = QT_QPA_PLATFORM, wayland
env = QT_QPA_PLATFORMTHEME, kde
env = XDG_MENU_PREFIX, plasma-
env = TERMINAL,kitty -1
env = XDG_SESSION_DESKTOP,Hyprland
env = QT_QPA_PLATFORM,wayland;xcb
env = QT_WAYLAND_DISABLE_WINDOWDECORATION,1
env = QT_AUTO_SCREEN_SCALE_FACTOR,1
env = MOZ_ENABLE_WAYLAND,1
env = GDK_SCALE,1
env = ELECTRON_OZONE_PLATFORM_HINT,auto
env = HYPRCURSOR_THEME,Adwaita
env = HYPRCURSOR_SIZE,20
#exec-once = hyprctl setcursor phinger-cursors 20


env = HYPRCURSOR_THEME,macOS-hyprcursor
env = HYPRCURSOR_SIZE,28

env = QT_QPA_PLATFORM,wayland


env = GDK_SCALE,2
env = GDK_BACKEND,wayland

env = XDG_CURRENT_DESKTOP,Hyprland
env = XDG_SESSION_TYPE,wayland
env = XDG_MENU_PREFIX,arch-

env = SDL_VIDEO_DRIVER,wayland
env = SDL_AUDIO_DRIVER,pipewire
env = ELECTRON_OZONE_PLATFORM_HINT,wayland

env = SDL_VIDEO_WAYLAND_SCALE_TO_DISPLAY,1
env = STEAM_FORCE_DESKTOPUI_SCALING,1.25
env = AVALONIA_SCREEN_SCALE_FACTORS,eDP-1=1.25

env = XCURSOR_SIZE,18

# --- Input ---
input {
    kb_layout = us
    kb_variant = 
    kb_model =
#    kb_options = caps:escape
    kb_rules =
    repeat_rate = 50
    repeat_delay = 300
    numlock_by_default = true
    left_handed = false
    follow_mouse = 1
    mouse_refocus = false
    float_switch_override_focus = 2
    
    touchpad {
        natural_scroll = true
        scroll_factor = 0.3
        middle_button_emulation = true
        tap-to-click = true
        drag_lock = true
        disable_while_typing = true
    }
    
    sensitivity = 0
    accel_profile = flat
}

# --- General ---
general {
    gaps_in = 8
    gaps_out = 20
    border_size = 3
    col.active_border = rgba(cba6f7ff) rgba(f38ba8ff) rgba(eba0acff) rgba(fab387ff) rgba(f9e2afff) rgba(a6e3a1ff) rgba(94e2d5ff) rgba(89b4faff) rgba(74c7ecff) 45deg
    col.inactive_border = rgba(313244aa) rgba(45475aaa) 45deg
    layout = dwindle
    allow_tearing = true
    resize_on_border = true
    extend_border_grab_area = 15
    hover_icon_on_border = true
}

# --- Decoration ---
decoration {
    rounding = 18
    
    blur {
        enabled = true
        xray = true
        special = false
        new_optimizations = true
        size = 14
        passes = 3
        brightness = 1
        noise = 0.01
        contrast = 1
        popups = true
        popups_ignorealpha = 0.6
        input_methods = true
        input_methods_ignorealpha = 0.8
    }
    
    shadow {
        enabled = true
        ignore_window = true
        range = 30
        offset = 0 2
        render_power = 4
        color = rgba(00000010)
    }
    
    # Dim
    dim_inactive = true
    dim_strength = 0.025
    dim_special = 0.07
}

# --- Animations ---
animations {
    enabled = true
    
    # Bezier curves (duplicates removed)
    bezier = overshot, 0.05, 0.9, 0.1, 1.1
    bezier = smoothOut, 0.5, 0, 0.99, 0.99
    bezier = smoothIn, 0.25, 1, 0.5, 1
    bezier = realsmooth, 0.28, 0.29, 0.69, 1.08
    bezier = wind, 0.05, 0.9, 0.1, 1.05
    bezier = winIn, 0.1, 1.0, 0.1, 1.0
    bezier = winOut, 0.1, 1.0, 0.1, 1.0
    bezier = liner, 1, 1, 1, 1
    bezier = linear, 0, 0, 1, 1
    bezier = md3_standard, 0.2, 0, 0, 1
    bezier = md3_decel, 0.05, 0.8, 0.1, 1
    bezier = md3_accel, 0.3, 0, 0.8, 0.15
    bezier = crazyshot, 0.1, 1.5, 0.76, 0.92 
    bezier = hyprnostretch, 0.05, 0.9, 0.1, 1.0
    bezier = menu_decel, 0.1, 1, 0, 1
    bezier = menu_accel, 0.52, 0.03, 0.72, 0.08
    bezier = easeInOutCirc, 0.85, 0, 0.15, 1
    bezier = easeOutCirc, 0, 0.55, 0.45, 1
    bezier = easeOutExpo, 0.16, 1, 0.3, 1
    bezier = softAcDecel, 0.26, 0.26, 0.15, 1
    bezier = md2, 0.4, 0, 0.2, 1
    bezier = layerOut, 0.23, 1, 0.32, 1
    bezier = expressiveFastSpatial, 0.42, 1.67, 0.21, 0.90
    bezier = expressiveSlowSpatial, 0.39, 1.29, 0.35, 0.98
    bezier = expressiveDefaultSpatial, 0.38, 1.21, 0.22, 1.00
    bezier = emphasizedDecel, 0.05, 0.7, 0.1, 1
    bezier = emphasizedAccel, 0.3, 0, 0.8, 0.15
    bezier = standardDecel, 0, 0, 0, 1
    
    # Window animations (final values kept)
    animation = windows, 1, 2.0, md3_decel, popin 60%
    animation = windowsIn, 1, 3, emphasizedDecel, popin 80%
    animation = windowsOut, 1, 2, emphasizedDecel, popin 90%
    animation = windowsMove, 1, 3, emphasizedDecel, slide
    
    # Border animations
    animation = border, 1, 10, emphasizedDecel
    animation = borderangle, 1, 100, linear, loop
    
    # Fade animations
    animation = fade, 1, 4, md3_decel
    animation = fadeDim, 1, 8, smoothIn
    animation = fadeLayersIn, 1, 0.5, menu_decel
    animation = fadeLayersOut, 1, 2.7, menu_accel
    
    # Layer animations
    animation = layersIn, 1, 2.7, emphasizedDecel, popin 93%
    animation = layersOut, 1, 2.4, menu_accel, popin 94%
    
    # Workspace animations
    animation = workspaces, 1, 7, menu_decel, slide
    animation = workspacesIn, 1, 7, winIn, slide
    animation = workspacesOut, 1, 7, winOut, slide
    
    # Special workspace animations
    animation = specialWorkspace, 1, 3, realsmooth, slidevert
    animation = specialWorkspaceIn, 1, 2.8, emphasizedDecel, slidevert
    animation = specialWorkspaceOut, 1, 1.2, emphasizedAccel, slidevert
}

# Blur configuration
blurls = waybar
blurls = rofi
blurls = swaync-notification-window
blurls = swaync-control-center
blurls = ags
blurls = gtk-layer-shell

# --- Dwindle Layout ---
dwindle {
    pseudotile = true
    preserve_split = true
    smart_split = false
    smart_resizing = true
    force_split = 0
    special_scale_factor = 0.8
    split_width_multiplier = 1.0
    use_active_for_splits = true
    default_split_ratio = 1.0
#    no_gaps_when_only = false
}


# Gestures
gestures {
    workspace_swipe = true
    workspace_swipe_fingers = 3
    workspace_swipe_distance = 300
    workspace_swipe_invert = true
    workspace_swipe_min_speed_to_force = 30
    workspace_swipe_cancel_ratio = 0.5
    workspace_swipe_create_new = true
    workspace_swipe_direction_lock = true
    workspace_swipe_direction_lock_threshold = 10
    workspace_swipe_forever = false
#    workspace_swipe_numbered = false
    workspace_swipe_use_r = false
}

# Master layout settings
master {
    allow_small_split = false
    special_scale_factor = 0.8
    mfact = 0.55
#    new_is_master = true
    new_on_top = false
#    no_gaps_when_only = false
    orientation = left
    inherit_fullscreen = true
#    always_center_master = false
}

# --- Misc ---
misc {
    disable_hyprland_logo = true
    disable_splash_rendering = true
    force_default_wallpaper = 0
    vfr = true
    vrr = 2
    mouse_move_enables_dpms = true
    key_press_enables_dpms = true
    always_follow_on_dnd = true
    layers_hog_keyboard_focus = true
    animate_manual_resizes = true
    animate_mouse_windowdragging = true
    disable_autoreload = false
    enable_swallow = true
    swallow_regex = ^(kitty|Alacritty)$
    swallow_exception_regex = ^(wev)$
    focus_on_activate = false
    mouse_move_focuses_monitor = true
#    render_ahead_of_time = false
#    render_ahead_safezone = 1
#    cursor_zoom_factor = 1.0
#    cursor_zoom_rigid = false
    allow_session_lock_restore = false
    background_color = 0x111111
    close_special_on_empty = true
    new_window_takes_over_fullscreen = 0
}

# XWayland settings
xwayland {
    use_nearest_neighbor = true
    force_zero_scaling = false
}

# OpenGL settings
opengl {
    nvidia_anti_flicker = true
#    force_introspection = 2
}

# Group settings
group {
    insert_after_current = true
    focus_removed_window = true
    
    col.border_active = rgba(cba6f7ff) rgba(f38ba8ff) 45deg
    col.border_inactive = rgba(313244aa)
    col.border_locked_active = rgba(f9e2afff) rgba(fab387ff) 45deg
    col.border_locked_inactive = rgba(45475aaa)
    
    groupbar {
        enabled = true
        font_family = JetBrainsMono Nerd Font
        font_size = 8
        gradients = true
        render_titles = true
        scrolling = true
        text_color = rgba(cdd6f4ff)
        col.active = rgba(cba6f7aa)
        col.inactive = rgba(313244aa)
        col.locked_active = rgba(f9e2afaa)
        col.locked_inactive = rgba(45475aaa)
    }
}

# Window rules for visual effects
layerrule = xray 1, .*

#################
### BLUR RULES ###
#################

# System Bars & UI Elements
layerrule = blur, waybar
layerrule = blur, shell:bar
layerrule = blur, gtk-layer-shell
layerrule = blur, gtk4-layer-shell

# Notifications
layerrule = blur, swaync-notification-window
layerrule = blur, swaync-control-center
layerrule = blur, notifications
layerrule = blur, shell:notifications

# Launchers & Menus
layerrule = blur, rofi
layerrule = blur, launcher

# Session & Dialog
layerrule = blur, logout_dialog

# AGS Components
layerrule = blur, session[0-9]*
layerrule = blur, bar[0-9]*
layerrule = blur, barcorner.*
layerrule = blur, dock[0-9]*
layerrule = blur, indicator.*
layerrule = blur, overview[0-9]*
layerrule = blur, cheatsheet[0-9]*
layerrule = blur, sideright[0-9]*
layerrule = blur, sideleft[0-9]*
layerrule = blur, osk[0-9]*

# Quickshell Components
layerrule = blur, quickshell:.*
layerrule = blurpopups, quickshell:.*
layerrule = blur, quickshell:session
layerrule = blur, quickshell:backgroundWidgets

#################
### IGNORE ALPHA/ZERO RULES ###
#################

# System Bars
layerrule = ignorezero, waybar
layerrule = ignorezero, shell:bar

# Notifications
layerrule = ignorezero, swaync-notification-window
layerrule = ignorezero, swaync-control-center
layerrule = ignorezero, notifications
layerrule = ignorealpha 0.1, shell:notifications

# Launchers
layerrule = ignorezero, rofi
layerrule = ignorealpha 0.5, launcher
layerrule = ignorealpha 0.69, notifications

# GTK Layer Shell
layerrule = ignorezero, gtk-layer-shell

# AGS Components with Alpha Thresholds
layerrule = ignorealpha 0.6, bar[0-9]*
layerrule = ignorealpha 0.6, barcorner.*
layerrule = ignorealpha 0.6, dock[0-9]*
layerrule = ignorealpha 0.6, indicator.*
layerrule = ignorealpha 0.6, overview[0-9]*
layerrule = ignorealpha 0.6, cheatsheet[0-9]*
layerrule = ignorealpha 0.6, sideright[0-9]*
layerrule = ignorealpha 0.6, sideleft[0-9]*
layerrule = ignorealpha 0.6, osk[0-9]*

# Quickshell Components
layerrule = ignorealpha 0.79, quickshell:.*
layerrule = ignorealpha 0, quickshell:session
layerrule = ignorealpha 0.05, quickshell:backgroundWidgets

#################
### ANIMATION RULES ###
#################

# Slide Animations
layerrule = animation slide left, sideleft.*
layerrule = animation slide right, sideright.*
layerrule = animation slide, swaync-notification-window
layerrule = animation slide, quickshell:bar
layerrule = animation slide, quickshell:verticalBar
layerrule = animation slide right, quickshell:sidebarRight
layerrule = animation slide left, quickshell:sidebarLeft
layerrule = animation slide bottom, quickshell:osk
layerrule = animation slide bottom, quickshell:dock

# Popin Animations
layerrule = animation popin 95%, logout_dialog
layerrule = animation popin 95%, rofi
layerrule = animation popin 95%, swaync-control-center
layerrule = animation popin 120%, quickshell:screenCorners

# Fade Animations
layerrule = animation fade, quickshell:screenCorners
layerrule = animation fade, quickshell:notificationPopup

# No Animation Rules
layerrule = noanim, walker
layerrule = noanim, selection
layerrule = noanim, overview
layerrule = noanim, anyrun
layerrule = noanim, indicator.*
layerrule = noanim, osk
layerrule = noanim, hyprpicker
layerrule = noanim, noanim
layerrule = noanim, quickshell:session
layerrule = noanim, quickshell:overview
layerrule = noanim, quickshell:screenshot
layerrule = noanim, quickshell:lockWindowPusher
layerrule = noanim, gtk4-layer-shell

#################
### SPECIAL EFFECTS ###
#################

# Dim Around Effect
layerrule = dimaround, rofi

# Blur Popups
layerrule = blurpopups, waybar
layerrule = blurpopups, quickshell:.*

# Unset Rules (for special cases)
layerrule = unset, rofi

plugin {
    hyprexpo {
        columns = 3
        gap_size = 5
        bg_col = rgb(000000)
        workspace_method = first 1 # [center/first] [workspace] e.g. first 1 or center m+1

        enable_gesture = false # laptop touchpad, 4 fingers
        gesture_distance = 300 # how far is the "max"
        gesture_positive = false
    }
}

plugin {
    hyprbars {
        # Honestly idk if it works like css, but well, why not
        bar_text_font = Rubik, Geist, AR One Sans, Reddit Sans, Inter, Roboto, Ubuntu, Noto Sans, sans-serif
        bar_height = 30
        bar_padding = 10
        bar_button_padding = 5
        bar_precedence_over_border = true
        bar_part_of_window = true

        bar_color = rgba(1D1011FF)
        col.text = rgba(F7DCDEFF)


        # example buttons (R -> L)
        # hyprbars-button = color, size, on-click
        hyprbars-button = rgb(F7DCDE), 13, 󰖭, hyprctl dispatch killactive
        hyprbars-button = rgb(F7DCDE), 13, 󰖯, hyprctl dispatch fullscreen 1
        hyprbars-button = rgb(F7DCDE), 13, 󰖰, hyprctl dispatch movetoworkspacesilent special
    }
}

# --- Plugin Configs ---
plugin:burn-my-windows {
#    animation = incinerate
}